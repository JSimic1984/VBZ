-- Aufgabe 1

create schema `pr_02_sales_Jelena` default character set utf8;

-- Aufgabe 2

CREATE TABLE `kunde` (
  `knr` int NOT NULL,
  `kundename` varchar(45) DEFAULT NULL,
  `ort` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`knr`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8

CREATE TABLE `auto` (
  `anr` int NOT NULL,
  `automarke` varchar(45) DEFAULT NULL,
  `typ` varchar(45) DEFAULT NULL,
  `seriennummer` int DEFAULT NULL,
  PRIMARY KEY (`anr`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8

CREATE TABLE `verkaeufe` (
  `id` int NOT NULL,
  `knr` int DEFAULT NULL,
  `verkauf_datum` date DEFAULT NULL,
  `vnr` int DEFAULT NULL,
  `anr` int DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE =InnoDB default CHASET=utf8

CREATE TABLE `verkaeufer` (
  `vnr` int NOT NULL,
  `verkaeufer` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`vnr`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8

-- Aufgabe 3

INSERT INTO pr_02_sales_Jelena.kunde (knr,kundename,ort)
	VALUES (1,'Meier','Basel');
INSERT INTO pr_02_sales_Jelena.kunde (knr,kundename,ort)
	VALUES (2,'Müller','Zürich');
INSERT INTO pr_02_sales_Jelena.kunde (knr,kundename,ort)
	VALUES (3,'Steffen','Muttenz');
INSERT INTO pr_02_sales_Jelena.kunde (knr,kundename,ort)
	VALUES (4,'Steffen','Aarau');

INSERT INTO pr_02_sales_Jelena.auto (anr,automarke,typ,seriennummer)
	VALUES (1,'VW','Golf',123456);
INSERT INTO pr_02_sales_Jelena.auto (anr,automarke,typ,seriennummer)
	VALUES (2,'Opel','Astra',34567);
INSERT INTO pr_02_sales_Jelena.auto (anr,automarke,typ,seriennummer)
	VALUES (3,'VW','Golf',388721);
INSERT INTO pr_02_sales_Jelena.auto (anr,automarke,typ,seriennummer)
	VALUES (4,'VW','Bora',222245);
INSERT INTO pr_02_sales_Jelena.auto (anr,automarke,typ,seriennummer)
	VALUES (5,'Audi','A6',122154);
INSERT INTO pr_02_sales_Jelena.auto (anr,automarke,typ,seriennummer)
	VALUES (6,'Opel','Antara',445321);


INSERT INTO pr_02_sales_Jelena.verkaeufe (id,knr,verkauf_datum,vnr,anr)
	VALUES (1,1,'23.4.2020',1,1);
INSERT INTO pr_02_sales_Jelena.verkaeufe (id,knr,verkauf_datum,vnr,anr)
	VALUES (2,1,'7.7.2020',2,2);
INSERT INTO pr_02_sales_Jelena.verkaeufe (id,knr,verkauf_datum,vnr,anr)
	VALUES (3,2,'17.6.2020',3,3);
INSERT INTO pr_02_sales_Jelena.verkaeufe (id,knr,verkauf_datum,vnr,anr)
	VALUES (4,3,'15.7.2020',1,4);
INSERT INTO pr_02_sales_Jelena.verkaeufe (id,knr,verkauf_datum,vnr,anr)
	VALUES (5,4,'13.7.2020',3,5);


INSERT INTO pr_02_sales_Jelena.verkaeufer (vnr,verkaeufer)
	VALUES (1,'Schmid');
INSERT INTO pr_02_sales_Jelena.verkaeufer (vnr,verkaeufer)
	VALUES (2,'Plüss');
INSERT INTO pr_02_sales_Jelena.verkaeufer (vnr,verkaeufer)
	VALUES (3,'Frey');
INSERT INTO pr_02_sales_Jelena.verkaeufer (vnr,verkaeufer)
	VALUES (4,'Schenk');

-- Aufgabe 4

alter table pr_02_sales_Jelena.verkaufe add CONSTRAINT `verkaeufe_fk` FOREIGN KEY (`knr`) REFERENCES `kunde` (`knr`);
ALTER TABLE pr_02_sales_Jelena.verkaeufe ADD CONSTRAINT `verkaeufe_fk` FOREIGN KEY (`anr`) references `auto`(anr);
ALTER TABLE pr_02_sales_Jelena.verkaeufe ADD CONSTRAINT `verkaeufe_fk` FOREIGN KEY (vnr) REFERENCES `verkaeufer`(vnr);

-- Aufgabe 6
create or replace view pr_02_sales_Jelena.verkaeufe_all
 as select
    v.id as knr,
    v.knr,
    v.verkauf_datum,
    v.vnr,
    v.anr,
    a.anr as verkaeufe_auto,
    a.automarke as verkaeufe_automarke,
    a.typ as verkaeufe_typ,
    a.seriennummer as verkaeufe_seriennummer,
    k.knr,
    k.kundename as verkaeufe_kunde,
    k.knr,
    k.ort,
    v2.vnr,
    v2.verkaeufer
from
    pr_02_sales_Jelena.verkaeufe v
inner join pr_02_sales_Jelena.auto a on
    v.anr = a.anr
inner join pr_02_sales_Jelena.kunde k on
    v.knr = k.knr
inner join pr_02_sales_Jelena.verkaeufer v2 on
    v.vnr = v2.vnr

  
    select 
    *
from
    pr_02_sales_Jelena.kunde k
join pr_02_sales_Jelena.auto a on
    v.anr = a.anr
inner join pr_02_sales_Jelena.verkaeufe v on
    k.knr = v.knr
inner join pr_02_sales_Jelena.verkaeufer v2 on
    v.vnr = v2.vnr
order by
    k.kundename,
    k.ort,
    a.automarke,
    a.typ,
    v.verkauf_datum,
    v2.verkaeufer
    
  -- Aufgaben 7 
    
create or replace view pr_02_sales_Jelena.auto_no_sale
 as select


 
 select
    *
from
    pr_02_sales_Jelena.verkaeufer v
inner join pr_02_sales_Jelena.auto a on
    v2.anr = a.anr
join pr_02_sales_Jelena.kunde k on
    v2.knr = k.knr
inner join pr_02_sales_Jelena.verkaeufe v2 on
    v.vnr = v2.vnr  
